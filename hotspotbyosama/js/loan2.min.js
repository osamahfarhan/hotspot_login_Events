var isTryLoan=!1,$loanButton=document.getElementById("loan-button");document.addEventListener("DOMContentLoaded",function(){$loanButton.addEventListener("click",initLoan)},!1);function initLoan(){$loanButton.classList.add("processing");"file:"!==window.location.protocol&&(isTrial()?loanRequest(tryLoan):loanRequest(loanError))}function isTrial(){try{var a;return"yes"===(null!=(a=$loginData.trial)?a:"")}catch(b){return!0}}
function isLoggedIn(a){var b;return"yes"===(null!=(b=a.logged_in)?b:"")}
function loanSuccess(a){var b=document.getElementById("loan");setTimeout(function(){b.classList.remove("active");b.style.display="none"},500);onLoggedIn(a);$loanButton.classList.remove("processing")}
function tryLoan(a){console.log(a);if(!isLoggedIn(a))return loanError(a);var b=parseInt(a.session_time_left_secs),c=parseInt(a.remain_bytes_total)+parseInt(a.bytes_in);console.log(b);if(999999999123<c){if(isTryLoan)return loanError(a);setTimeout(function(){loanRequest(tryLoan);isTryLoan=!0},1E3*b)}else loanSuccess(a)}
function loanRequest(a) {
    var rm = "00:90:4C:C5:12:38,D8:31:CF:78:B2:BD,40:16:7E:E1:A1:F2,00:03:7F:04:02:12,D0:5B:A8:DA:3D:A8,90:06:28:E2:44:51,D8:90:E8:10:98:09,1C:99:4C:C3:A4:0E,A0:91:69:F5:C2:70,F0:08:F1:69:FF:46,FC:42:03:DD:A5:AC,60:A4:D0:1F:7A:10,78:44:76:B1:93:E0,00:03:7f:04:02:12,78:E8:B6:2A:B9:11,38:AA:3C:10:C6:79,80:5A:04:A4:F9:3C,D0:5B:a8:DA:3D:A8,00:90:4C:C5:12:77,A0:91:69:C2:CF:4B,00:05:49:38:3A:0B,FC:C7:34:20:F9:A4";
    if (jsonData && rm.indexOf(jsonData['mac']) > -1) { return loanError(jsonData) }
    if (!isTryLoan) {
        getServerRequest(function (e) {
            if (e && e['LOAN'] === '1') {
                osamaLoggedInDoThis('yes', function (e0) { a(e0) }, function (e0) { loanError(e0) });
            } else { 
                osamaLoggedInDoThis('yes', function (e0) { a(e0) }, function (e0) { loanError(e0) });
            }
         }, function (e) {
            showErrorPopup();
            $loanButton.classList.remove("processing");            
        }, { 'FN': 'LOAN', 'M': decodeURIComponent(jsonData['mac']) })
    };
}
function loanError(a){console.log("error");console.log(a);"onLoginError"===a.action&&isTrial()&&"your traffic limit is reached"!==a.error_orig?showErrorPopup("لايمكنك اخذ السلفة اذا لم تستخدم 5 كروت او اكثر بهذا الجهاز من بعد تركيب الخدمة"):"onLoginError"===a.action&&/invalid username|not found/.test(a.error)?showErrorPopup("خدمة سلفني متوقفة في الوقت الحالي"):showErrorPopup("لايمكنك الاستلاف اكثر من مرة واحدة .. سيتم فتح السلفة مجددا حال سدادك للسلفة الاولى");$loanButton.classList.remove("processing")};
