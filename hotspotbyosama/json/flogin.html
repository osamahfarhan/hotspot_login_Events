$(if http-status == 200)OK$(endif)
$(if http-header == "Cache-Control")no-store$(endif)
$(if http-header == "Content-Type")application/json$(endif)
$(if http-header == "Access-Control-Allow-Origin")*$(endif)
$(if http-header == "Cross-Origin-Resource-Policy")cross-origin$(endif)
$(if http-header == "X-Eng-Osamah-Error")$(if error == '')none$(endif)$(if error != '')Error=$(error-orig-esc)$(endif)$(endif)
{
    "idle_timeout": "$(idle-timeout)",
    "refresh_timeout": "$(refresh-timeout)",
    "uptime": "$(uptime)",
    "session_timeout": "$(if session-timeout == '')00$(else)$(session-timeout)$(endif)",
    "session_time_left": "$(if session-time-left == '')00$(else)$(session-time-left)$(endif)",
    "bytes_in_nice": "$(bytes-in-nice)",
    "bytes_out_nice": "$(bytes-out-nice)",
    "idle_timeout_secs": "$(idle-timeout-secs)",
    "refresh_timeout_secs": "$(refresh-timeout-secs)",
    "uptime_secs": "$(uptime-secs)",
    "limit_bytes_in": "$(limit-bytes-in)",
    "limit_bytes_out": "$(limit-bytes-out)",
    "limit_bytes_total": "$(limit-bytes-total)",
    "session_timeout_secs": "$(session-timeout-secs)",
    "session_time_left_secs": "$(if session-time-left-secs == '0')00$(else)$(session-time-left-secs)$(endif)",
    "bytes_in": "$(bytes-in)",
    "bytes_out": "$(bytes-out)",
    "packets_in": "$(packets-in)",
    "packets_out": "$(packets-out)",
    "bytes_total": "$(bytes-in).$(bytes-out)",
    "remain_bytes_in": "$(remain-bytes-in)",
    "remain_bytes_out": "$(remain-bytes-out)",
    "remain_bytes_total": "$(if remain-bytes-total == '')00$(else)$(remain-bytes-total)$(endif)",
    "login_by_mac": "$(login-by-mac)",
    "logged_in": "$(logged-in)",
    "erase_cookie": "$(if erase-cookie)$(erase-cookie)$(endif)",
    "popup": "$(if popup)$(popup)$(endif)",
    "advert_pending": "$(advert-pending)",
    "blocked": "$(blocked)",
    "trial": "$(trial)",
    "radius": "$(radius)",
    "plain_passwd": "$(plain-passwd)",
    "ssl_login": "$(ssl-login)",
    "chap_id": "$(if chap-id != '')$(chap-id-esc)$(endif)",
    "chap_challenge": "$(if chap-challenge != '')$(chap-challenge-esc)$(endif)",
    "error": "$(error)",
    "error_orig": "$(error-orig)",
    "error_type": "$(error-type)",
    "session_id": "$(session-id)",
    "server_address": "$(server-address)",
    "vlan_id": "$(vlan-id)",
    "ip": "$(ip)",
    "host_ip": "$(host-ip)",
    "link_orig": "$(if link-orig)$(link-orig-esc)$(endif)",
    "link_redirect": "$(if link-redirect)$(link-redirect-esc)$(endif)",
    "link_login": "$(link-login-esc)",
    "link_login_only": "$(link-login-only-esc)",
    "link_logout": "$(link-logout-esc)",
    "link_status": "$(link-status-esc)",
    "link_advert": "$(link-advert-esc)",
    "var": "$(var-esc)",
    "login_by": "$(login-by)",
    "mac": "$(mac-esc)",
    "username": "$(username-esc)",
    "domain": "$(domain-esc)",
    "user_agent": "$(user-agent-esc)",
    "target_dir": "$(target-dir-esc)",
    "dst": "$(link-orig-esc)",
    "hostname": "$(hostname-esc)",
    "identity": "$(identity-esc)",
    "interface_name": "$(interface-name-esc)",
    "server_name": "$(server-name-esc)",
    "location_id": "$(location-id-esc)",
    "location_name": "$(location-name-esc)",
    $(if username == "BLOCKED")
        "action": "onBLOCKED"
    $(elif error-orig-esc == "simultaneous+session+limit+reached")
        "action" : "onLoginErrorKick"
    $(elif error-orig-esc == "no+more+sessions+are+allowed+for+user")
        "action" : "onLoginErrorKick"
    $(elif error-esc == "You+are+already+logged+in+-+access+denied")
        "action" : "onLoginErrorKick"
    $(elif error-orig-esc == "You+are+already+logged+in+-+access+denied")
        "action" : "onLoginErrorKick"
    $(elif error-orig-esc == "invalid+password")
        "action" : "onLoginErrorInvalidPassword"
    $(elif error != '')
        "action": "onLoginError"
    $(elif var == "callBack")
        "action": "onLoginError"
    $(elif var == '')
        "action": "onLoginStart"
    $(else)
        "action": "onLoginError"
    $(endif)
}