var ERROR_TYPES={READY_STATUS_ERROR:1,TRY_CATCH_ERROR:2},loanLoginData,isTryLoan=!1,loanTryCount=0,$loanButton=document.getElementById("loan-button");document.addEventListener("DOMContentLoaded",function(){$loanButton.addEventListener("click",initLoan)},!1);
function initLoan(a,b){if("file:"!==window.location.protocol){void 0===loanLoginData&&(loanLoginData=clone($loginData));void 0!==a&&"PointerEvent"!==a.constructor.name&&void 0===b&&(loanLoginData=a);if(3<=loanTryCount)return showLoanError("هذة الخدمة متوقفة في الوقت الحالي");console.log(loanLoginData);void 0===loanLoginData||null==loanLoginData?(console.log("loanLoginData not set"),loanRequest("/json/login?var=callBack",initLoan,initLoan)):(loanTryCount=0,$loanButton.classList.add("processing"),isTrial()?
loanRequest("/json/login?username=T-".concat(loanLoginData.mac,"&var=callBack"),onRequestSuccess,onRequestFail):showLoanError("هذة الخدمة متوقفة في الوقت الحالي"))}}function isTrial(){console.log(loanLoginData);try{var a;return"yes"===(null!=(a=loanLoginData.trial)?a:"")}catch(b){return!1}}function onRequestFail(a,b){getRequest("/json/status");showLoanError("لايمكنك استخدام هذة الخدمة اذا لم تستخدم 5 كروت او اكثر بهذا الجهاز اخر 30 يوما")}
function onRequestSuccess(a){console.log("onRequestSuccess");if(!isLoggedIn(a))return loanError(a);loanLoginData=a;var b=parseInt(a.session_time_left_secs);999999999123<parseInt(a.remain_bytes_total)+parseInt(a.bytes_in)?3<=loanTryCount?showLoanError("لايمكنك استخدام هذة الخدمة  اذا لم تستخدم 5 كروت او اكثر بهذا الجهاز اخر 30 يوما"):setTimeout(function(){loanRequest("/json/login?username=T-".concat(loanLoginData.mac,"&var=callBack"),onRequestSuccess,onRequestFail);loanTryCount++},1E3*b):(""!==a.remain_bytes_total||
""!==a.session_time_left||""!==a.username)&&loanSuccess(a)}function isLoggedIn(a){try{var b;return"yes"===(null!=(b=a.logged_in)?b:"")}catch(c){return!1}}function loanSuccess(a){var b=document.getElementById("loan");setTimeout(function(){b.classList.remove("active");b.style.display="none"},500);onLoggedIn(a);$loanButton.classList.remove("processing")}
function loanError(a){var b="لايمكنك استخدام هذة الخدمة  اكثر من مرة واحدة .. سيتم فتح هذة الخدمة عند استخدامك لكرت جديد";"onLoginError"===a.action&&isTrial()&&"your traffic limit is reached"!==a.error_orig?b="لايمكنك استخدام هذة الخدمة  اذا لم تستخدم 5 كروت او اكثر بهذا الجهاز اخر 30 يوما":"onLoginError"===a.action&&/invalid username|invalid username or password|not found/.test(a.error)&&(b="هذة الخدمة متوقفة في الوقت الحالي");showLoanError(b)}
function showLoanError(a){document.getElementById("error").innerText=a;showErrorPopup();$loanButton.classList.remove("processing")}
function loanRequest(a,b,c,d){void 0===d&&(d=0);var e=new XMLHttpRequest;e.open("GET",a,!0);e.onreadystatechange=function(){if(4===this.readyState){var f=this.responseText;try{var g=JSON.parse(f);g=osamaDecode(g,!0);void 0!==b&&b(g)}catch(h){void 0!==c&&c(ERROR_TYPES.TRY_CATCH_ERROR,h)}}};e.onerror=function(f){3>d?loanRequest(a,b,c,d+1):void 0!==c&&c(ERROR_TYPES.READY_STATUS_ERROR,f)};e.send()}
function clone(a){if(null==a||"object"!=typeof a)return a;var b=a.constructor(),c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};
